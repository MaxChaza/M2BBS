buffer == 2 * ready_to_send == 1 * ready_to_consume == 1
